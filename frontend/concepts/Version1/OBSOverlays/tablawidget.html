<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RankIT Overlay - Leaderboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@400;600;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'], display: ['Chakra Petch', 'sans-serif'] },
                    colors: { brand: { cyan: '#06B6D4', purple: '#7C3AED' } }
                }
            }
        }
    </script>
    <style>
        /* Fondo transparente para OBS */
        body { background-color: transparent; overflow: hidden; }
        
        /* Contenedor principal del widget */
        .widget-container {
            width: 400px;
            background: rgba(11, 12, 21, 0.95);
            border-radius: 16px;
            border: 2px solid rgba(6, 182, 212, 0.3);
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            padding: 16px;
            position: relative;
            overflow: hidden;
        }

        /* Línea decorativa superior */
        .top-line {
            position: absolute; top: 0; left: 0; right: 0; height: 4px;
            background: linear-gradient(90deg, #7C3AED, #06B6D4);
        }

        /* Animación de lista */
        .leaderboard-list { position: relative; min-height: 300px; }
        .player-row {
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: absolute;
            width: 100%;
            left: 0;
        }
        
        /* Estilos de fila */
        .row-inner {
            display: flex; align-items: center; justify-content: space-between;
            background: rgba(255, 255, 255, 0.05);
            padding: 8px 12px;
            border-radius: 8px;
            border-left: 3px solid transparent;
        }
        .row-inner.top-1 { border-left-color: #FFD700; background: linear-gradient(90deg, rgba(255, 215, 0, 0.1), transparent); }
        .row-inner.top-2 { border-left-color: #C0C0C0; }
        .row-inner.top-3 { border-left-color: #CD7F32; }

    </style>
</head>
<body>

    <div class="widget-container mx-auto mt-10">
        <div class="top-line"></div>
        
        <!-- Header del Widget -->
        <div class="flex justify-between items-center mb-4 border-b border-gray-700 pb-2">
            <div class="flex items-center gap-2">
                <!-- Cometax Logo SVG Small -->
                <svg class="w-6 h-6" viewBox="0 0 100 100" fill="none">
                    <path d="M20 80 L50 50 L80 20" stroke="#06B6D4" stroke-width="8" stroke-linecap="round" />
                    <circle cx="20" cy="80" r="10" fill="#06B6D4" />
                </svg>
                <h2 class="font-display font-bold text-white uppercase tracking-wider text-sm">Top Players</h2>
            </div>
            <span class="text-[10px] text-brand-cyan bg-brand-cyan/10 px-2 py-0.5 rounded animate-pulse">LIVE</span>
        </div>

        <!-- Lista Dinámica -->
        <div id="leaderboard" class="leaderboard-list">
            <!-- Las filas se generan con JS -->
        </div>

        <!-- Footer -->
        <div class="mt-4 text-center">
            <p class="text-[10px] text-gray-500 font-display">POWERED BY COMETAX</p>
        </div>
    </div>

    <script>
        // Datos iniciales simulados
        let players = [
            { id: 1, name: "SkullCrusher", score: 1500, avatar: "https://i.pravatar.cc/150?img=11" },
            { id: 2, name: "NinjaTacos", score: 1450, avatar: "https://i.pravatar.cc/150?img=12" },
            { id: 3, name: "ViperMain", score: 1320, avatar: "https://i.pravatar.cc/150?img=13" },
            { id: 4, name: "NoobMaster", score: 1200, avatar: "https://i.pravatar.cc/150?img=14" },
            { id: 5, name: "CometaxPro", score: 1100, avatar: "https://i.pravatar.cc/150?img=15" },
        ];

        const listContainer = document.getElementById('leaderboard');
        const ROW_HEIGHT = 55; // Altura de cada fila + margen

        // Función para renderizar (o actualizar posiciones)
        function renderLeaderboard() {
            // Ordenar por puntaje descendente
            players.sort((a, b) => b.score - a.score);

            players.forEach((player, index) => {
                let row = document.getElementById(`player-${player.id}`);
                
                // Si no existe, crearlo
                if (!row) {
                    row = document.createElement('div');
                    row.id = `player-${player.id}`;
                    row.className = 'player-row';
                    row.innerHTML = `
                        <div class="row-inner top-${index + 1}">
                            <div class="flex items-center gap-3">
                                <span class="font-display font-bold text-gray-400 w-4 text-center text-sm rank-num">${index + 1}</span>
                                <img src="${player.avatar}" class="w-8 h-8 rounded-full border border-gray-600">
                                <span class="text-white font-bold text-sm truncate w-24">${player.name}</span>
                            </div>
                            <span class="font-mono text-brand-cyan font-bold score-val">${player.score}</span>
                        </div>
                    `;
                    listContainer.appendChild(row);
                }

                // Actualizar posición (Animación CSS)
                row.style.transform = `translateY(${index * ROW_HEIGHT}px)`;
                
                // Actualizar estilos internos (colores de Top 1, 2, 3)
                const inner = row.querySelector('.row-inner');
                inner.className = `row-inner top-${index + 1}`; // Reset clases
                
                // Actualizar texto de ranking y puntaje
                row.querySelector('.rank-num').innerText = index + 1;
                
                // Animación de números si cambia el puntaje
                const scoreEl = row.querySelector('.score-val');
                if (scoreEl.innerText != player.score) {
                    scoreEl.innerText = player.score;
                    scoreEl.classList.add('text-white'); // Flash effect simple
                    setTimeout(() => scoreEl.classList.remove('text-white'), 300);
                }
            });
        }

        // Simulación de WebSocket (Backend Updates)
        function simulateRealTimeUpdates() {
            setInterval(() => {
                // Elegir un jugador al azar y aumentar puntos
                const randomPlayer = players[Math.floor(Math.random() * players.length)];
                const points = Math.floor(Math.random() * 50) + 10;
                
                console.log(`Update: ${randomPlayer.name} +${points}pts`);
                randomPlayer.score += points;

                renderLeaderboard();
            }, 2500); // Actualiza cada 2.5 segundos
        }

        // Iniciar
        renderLeaderboard();
        simulateRealTimeUpdates();

    </script>
</body>
</html>